# Focus APP 前端架构设计

## 🏗️ 整体架构设计

### 应用架构图
```
┌─────────────────────────────────────────────────────────────┐
│                    Focus APP (Android)                      │
├─────────────────────────────────────────────────────────────┤
│  UI Layer (Jetpack Compose)                                 │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐│
│  │   MainScreen    │  │  SearchScreen   │  │  SettingsScreen ││
│  └─────────────────┘  └─────────────────┘  └─────────────────┘│
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐│
│  │ ReminderOverlay │  │ PermissionGuide │  │  StatsScreen    ││
│  │  (悬浮窗)       │  │                 │  │                 ││
│  └─────────────────┘  └─────────────────┘  └─────────────────┘│
├─────────────────────────────────────────────────────────────┤
│  ViewModel Layer                                             │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐│
│  │ MainViewModel   │  │ SearchViewModel │  │SettingsViewModel││
│  └─────────────────┘  └─────────────────┘  └─────────────────┘│
├─────────────────────────────────────────────────────────────┤
│  Service Layer (后台服务)                                    │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐│
│  │UsageTrackerSvc  │  │ReminderService  │  │OverlayService   ││
│  │  (使用追踪)     │  │  (提醒服务)     │  │  (悬浮窗服务)    ││
│  └─────────────────┘  └─────────────────┘  └─────────────────┘│
├─────────────────────────────────────────────────────────────┤
│  Repository Layer                                            │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐│
│  │SearchRepository │  │UsageRepository  │  │SettingsRepository││
│  └─────────────────┘  └─────────────────┘  └─────────────────┘│
├─────────────────────────────────────────────────────────────┤
│  Data Layer                                                  │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐│
│  │ Room Database   │  │ SharedPreferences│  │  Accessibility  ││
│  │   (Local Data)  │  │   (Settings)    │  │    Service      ││
│  └─────────────────┘  └─────────────────┘  └─────────────────┘│
└─────────────────────────────────────────────────────────────┘
```

### 页面导航流程图
```
┌─────────────┐
│  启动页面   │
│ (Splash)    │
└──────┬──────┘
       │
       ▼
┌─────────────┐
│  主界面     │◄─────────────────┐
│ (Main)      │                  │
└──────┬──────┘                  │
       │                         │
       ├─────────┬───────────────┘
       │         │
       ▼         ▼
┌─────────────┐ ┌─────────────┐
│ 搜索界面     │ │ 设置界面     │
│ (Search)     │ │ (Settings)   │
└──────┬──────┘ └──────┬──────┘
       │               │
       ▼               ▼
┌─────────────┐ ┌─────────────┐
│ 小红书APP    │ │ 权限引导     │
│ (跳转-不返回)│ │ (Permission)│
└─────────────┘ └──────┬──────┘
       │                     │
       │                     ▼
       │            ┌─────────────┐
       │            │ 提醒对话框   │
       │            │ (悬浮窗)     │
       │            └─────────────┘
       │
       ▼
┌─────────────┐
│ 后台监控     │
│ (服务)       │
└─────────────┘
```

## 🎨 页面低保真原型设计

### 1. 主界面 (MainScreen)
```
┌─────────────────────────────────────────────────────────────┐
│                    Focus                                    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │  搜索关键词...                                      │    │
│  │  [搜索框]                                          │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐         │
│  │   小红书    │  │   抖音      │  │    B站      │         │
│  │  (选中)     │  │  (未选)     │  │  (未选)     │         │
│  └─────────────┘  └─────────────┘  └─────────────┘         │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │                   [搜索]                             │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  今日使用时长: 25分钟                                       │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │  小红书: 25分钟                                     │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  [设置]                                               [关于]│
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 2. 搜索界面 (SearchScreen)
```
┌─────────────────────────────────────────────────────────────┐
│                    搜索                                    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │  请输入搜索关键词                                      │    │
│  │  [输入框]                                            │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
│  选择搜索平台:                                             │
│                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐         │
│  │   小红书    │  │   抖音      │  │    B站      │         │
│  │  ● 选中     │  │   ○ 未选    │  │   ○ 未选    │         │
│  └─────────────┘  └─────────────┘  └─────────────┘         │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │                   [开始搜索]                         │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
│                                                             │
│  [返回]                                                    │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 3. 设置界面 (SettingsScreen)
```
┌─────────────────────────────────────────────────────────────┐
│                    设置                                    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  提醒设置                                                   │
│  ┌─────────────────────────────────────────────────────┐    │
│  │  使用时长提醒:                                       │    │
│  │  ○ 15分钟   ● 30分钟   ○ 60分钟                     │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │  提醒方式:                                           │    │
│  │  ✓ 弹窗提醒    ✓ 震动提醒    □ 声音提醒             │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  权限管理                                                   │
│  ┌─────────────────────────────────────────────────────┐    │
│  │  无障碍服务: [已授权]                               │    │
│  │  使用情况访问: [已授权]                             │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
│  [重新授权]                                               [权限说明]│
│                                                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  关于                                                       │
│  ┌─────────────────────────────────────────────────────┐    │
│  │  版本: 1.0.0                                        │    │
│  │  开发者: Focus Team                                 │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
│                                                             │
│  [返回]                                                    │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 4. 提醒悬浮窗 (ReminderOverlay)
```
┌─────────────────────────────────────────────────────────────┐
│                    ⏰ 使用提醒                               │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  您已使用小红书30分钟                                       │
│                                                             │
│  今日总时长: 30分钟                                         │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────┐  ┌─────────────────┐                 │
│  │   继续使用      │  │   停止使用      │                 │
│  └─────────────────┘  └─────────────────┘                 │
│                                                             │
│                                                             │
│  [今日不再提醒]  [关闭]                                     │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

**注意**: 提醒以悬浮窗形式显示，可在任何APP上层显示，用户可以拖动位置

### 5. 权限引导界面 (PermissionGuide)
```
┌─────────────────────────────────────────────────────────────┐
│                    权限说明                                │
├─────────────────────────────────────────────────────────────┐
│                                                             │
│  📱 需要以下权限才能正常使用Focus:                           │
│                                                             │
│  1. 无障碍服务                                              │
│     用于检测APP使用状态，记录使用时长                       │
│                                                             │
│  2. 使用情况访问                                            │
│     用于获取精确的APP使用时长数据                           │
│                                                             │
│                                                             │
│  🔒 我们承诺:                                              │
│  • 仅用于功能实现，不会收集您的隐私数据                     │
│  • 所有数据本地存储，不会上传到云端                         │
│  • 可以随时在设置中关闭权限                                 │
│                                                             │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │                   [立即授权]                         │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
│  [稍后设置]                                                │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## 🔄 用户交互流程

### 搜索功能流程
```
开始 → 主界面 → 输入关键词 → 选择平台 → 点击搜索 → 
跳转到小红书 → Focus进入后台监控模式 → 用户正常浏览
```

### 时间追踪流程
```
打开小红书 → Focus后台检测到 → 开始计时 → 实时记录时长 → 
关闭小红书 → Focus后台检测到 → 停止计时 → 保存数据
```

### 提醒功能流程
```
使用时长达到阈值 → 后台触发提醒 → 显示悬浮窗提醒 → 
用户选择(继续/停止) → 更新状态 → 继续后台监控
```

### 用户回看流程
```
用户想查看使用数据 → 重新打开Focus → 显示最新统计 → 
查看设置 → 修改提醒规则 → 后台继续监控
```

## 🎨 UI组件架构

### 基础组件结构
```
FocusTheme
├── Colors (颜色主题)
├── Typography (字体样式)
├── Shapes (形状样式)
└── Spacing (间距规范)

Components
├── SearchBar (搜索框)
├── PlatformSelector (平台选择器)
├── UsageCard (使用时长卡片)
├── ReminderDialog (提醒对话框)
├── PermissionGuide (权限引导)
└── SettingItem (设置项)
```

### 状态管理
```
AppState
├── SearchState (搜索状态)
│   ├── keyword (关键词)
│   ├── selectedPlatform (选中平台)
│   └── isSearching (搜索中)
├── UsageState (使用状态)
│   ├── currentUsage (当前使用时长)
│   ├── todayUsage (今日总时长)
│   └── isTracking (是否在追踪)
├── SettingsState (设置状态)
│   ├── reminderInterval (提醒间隔)
│   ├── reminderMethods (提醒方式)
│   └── permissions (权限状态)
└── UIState (界面状态)
    ├── isLoading (加载中)
    ├── showError (显示错误)
    └── showDialog (显示对话框)
```

## 📱 响应式设计

### 屏幕适配策略
```
小屏幕 (< 360dp)    → 紧凑布局，字体缩小
中屏幕 (360-600dp)  → 标准布局
大屏幕 (> 600dp)    → 宽松布局，充分利用空间
```

### 横屏适配
```
主界面: 搜索框和统计数据并排显示
设置界面: 设置项两列显示
提醒对话框: 居中显示，宽度限制
```

## 🎯 交互设计原则

### 1. 简洁直观
- 核心功能一键到达
- 操作流程最简化
- 视觉层次清晰

### 2. 反馈及时
- 点击立即响应
- 状态实时更新
- 错误明确提示

### 3. 一致性
- 统一的视觉风格
- 一致的交互模式
- 标准的手势操作

### 4. 可访问性
- 支持大字体
- 高对比度模式
- 屏幕阅读器支持